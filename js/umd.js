(function(a,i){typeof exports=="object"&&typeof module<"u"?module.exports=i():typeof define=="function"&&define.amd?define(i):(a=typeof globalThis<"u"?globalThis:a||self,a.GhostHelper=i())})(this,function(){var p;"use strict";let a=null;async function i(e,t){return a instanceof Promise||(a=new Promise((n,s)=>{const o=document.createElement("script");o.src=`https://proxy.beyondwords.io/npm/@beyondwords/player@${t}/dist/umd.js`,o.async=!0,o.onload=()=>{var d;const r=(d=window.BeyondWords)==null?void 0:d.Player;if(!r){s(new Error("Failed to load BeyondWords Player"));return}n(r)},o.onerror=r=>s(r),e.appendChild(o)})),a}function w(e){if(e instanceof Element)return e;if(typeof e=="string"){const c=document.querySelector(e);if(!c)throw new Error(`Target element "${e}" not found.`);return c}const t=document.querySelector(".beyondwords-target");if(t)return t;const n=document.body.classList.contains("post-template"),s=document.body.classList.contains("page-template");if(!n&&!s)throw new Error("Player is only available on Ghost Posts and Pages.");const o=document.querySelector(".post-full-content");if(o)return o;const r=document.querySelector("article");if(r){const c=r.querySelector("header");return c||r}const d=document.querySelector(".content");if(d)return d;throw new Error("Target not found. See https://ghost.org/integrations/beyondwords/#advanced for further information.")}function E(e){if(e instanceof Element)return e;if(typeof e=="string"){const r=document.querySelector(e);if(!r)throw new Error(`Content element "${e}" not found.`);return r}const t=document.querySelector(".beyondwords-content");if(t)return t;const n=document.body.classList.contains("post-template"),s=document.body.classList.contains("page-template");if(!n&&!s)throw new Error("Player is only available on Ghost Posts and Pages.");const o=document.querySelector(".gh-content");if(o)return o;throw new Error("Content not found. See https://ghost.org/integrations/beyondwords/#advanced for further information.")}async function g(){if(!(document.readyState==="complete"||document.readyState==="interactive"))return new Promise(e=>{document.addEventListener("DOMContentLoaded",()=>e())})}function v(){const e=document.createElement("div");return e.setAttribute("id","beyondwords-player"),e.style.width="100%",e}const y="beyondwordsMarker";function P(e){Array.from(e.children).filter(t=>t instanceof HTMLElement&&typeof t.dataset[y]!="string").forEach((t,n)=>t.dataset[y]=`segment-${n}`)}var C=(e,t,n)=>{if(!t.has(e))throw TypeError("Cannot "+n)},m=(e,t,n)=>(C(e,t,"read from private field"),n?n.call(e):t.get(e)),S=(e,t,n)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},l;const f=class u{constructor(t){this.playerLoader=this.init(t).then(n=>{this.player=n}).catch(n=>{throw console.error("BeyondWords.GhostHelper",n),n}),m(u,l).push(this)}async init(t){await g();const n=w(t.target),s=await i(n,u.version),o=v();if(n.insertBefore(o,n.firstChild),t.assignMarkersEnabled){const r=E(t.contentTarget);P(r)}return new s({sourceUrl:window.location.href,...t,target:o})}static instances(){return[...m(u,l)]}};l=new WeakMap,S(f,l,[]),f.version="latest";let h=f;return typeof window<"u"&&(window.BeyondWords||(window.BeyondWords={}),(p=window.BeyondWords).GhostHelper||(p.GhostHelper=h)),h});
//# sourceMappingURL=umd.js.map
